\chapter{Number theory}

\section{Modular arithmetic}
\importcode{code/number-theory/Mod.h}
\importcode{code/number-theory/BinaryExponentiation.h}
% \importcode{code/number-theory/ModLog.h}
% \importcode{code/number-theory/ModSum.h}
% \importcode{code/number-theory/ModMulLL.h}
% \importcode{code/number-theory/ModSqrt.h}

\section{Primality}
\importcode{code/number-theory/Sieve.h}
% \importcode{code/number-theory/MillerRabin.h}
% \importcode{code/number-theory/Factor.h}

\section{Divisibility}
\importcode{code/number-theory/Euclid.h}
% \importcode{code/number-theory/CRT.h}

\subsection{BÃ©zout's identity}
For $a \neq $, $b \neq 0$, then $d=gcd(a,b)$ is the smallest positive integer
for which there are integer solutions to $$ax+by=d$$ If $(x,y)$ is one
solution, then all solutions are given by $$\left(x+\frac{kb}{\gcd(a,b)},
   y-\frac{ka}{\gcd(a,b)}\right), \quad k\in\mathbb{Z}$$

\importcode{code/number-theory/Totient.h}

% \section{Fractions}
% \importcode{code/number-theory/ContinuedFractions.h}
% \importcode{code/number-theory/FracBinarySearch.h}

\section{Pythagorean Triples}
The Pythagorean triples are uniquely generated by
\[ a=k\cdot (m^{2}-n^{2}),\ \,b=k\cdot (2mn),\ \,c=k\cdot (m^{2}+n^{2}), \]
with $m > n > 0$, $k > 0$, $m \bot n$, and either $m$ or $n$ even.

\section{Primes}
$p=962592769$ is such that $2^{21} \mid p-1$, which may be useful. For hashing
use 970592641 (31-bit number), 31443539979727 (45-bit), 3006703054056749
(52-bit). There are 78498 primes less than 1\,000\,000.

Primitive roots exist modulo any prime power $p^a$, except for $p = 2, a > 2$,
and there are $\phi(\phi(p^a))$ many. For $p = 2, a > 2$, the group $\mathbb
   Z_{2^a}^\times$ is instead isomorphic to $\mathbb Z_2 \times \mathbb
   Z_{2^{a-2}}$.

\section{Number / Sum / Product of Divisors}
If the prime factorization of \( n \) is \( p_1^{e_1} \cdot p_2^{e_2} \cdots
p_k^{e_k} \), where \( p_i \) are distinct prime numbers, then:
\begin{itemize}
   \item Number of divisors is: $d(n) = (e_1 + 1) \cdot (e_2 + 1) \cdots (e_k + 1)$
   \item Sum of divisors is: $\sigma(n) = \frac{p_1^{e_1 + 1} - 1}{p_1 - 1} \cdot
            \frac{p_2^{e_2 + 1} - 1}{p_2 - 1} \cdots \frac{p_k^{e_k + 1} - 1}{p_k - 1}$
   \item Product of divisors is: $n^{\frac{d(n)}{2}}$
\end{itemize}
\importcode{code/number-theory/NumberSumProductofDivisors.h}

\section{Gray Code}
\importcode{code/number-theory/GrayCode.h}

\section{Fibonacci}
\importcode{code/number-theory/Fibonacci.h}

\section{Estimates}
$\sum_{d|n} d = O(n \log \log n)$.

The upper bound on the number of divisors is $n^{\frac{1}{3}}$ The number of
divisors of $n$ is at most around 100 for $n < 5e4$, 500 for $n < 1e7$, 1344
for $n < 1e9$, 2000 for $n < 1e10$, 200\,000 for $n < 1e19$.

\section{Mobius Function}
\[
   \mu(n) = \begin{cases} 0 & n \textrm{ is not square free}\\ 1 & n \textrm{ has even number of prime factors}\\ -1 & n \textrm{ has odd number of prime factors}\\\end{cases}
\]
Mobius Inversion:
\[ g(n) = \sum_{d|n} f(d) \Leftrightarrow f(n) = \sum_{d|n} \mu(d)g(n/d) \]
Other useful formulas/forms:

$ \sum_{d | n} \mu(d) = [ n = 1] $ (very useful)

$ g(n) = \sum_{n|d} f(d) \Leftrightarrow f(n) = \sum_{n|d} \mu(d/n)g(d)$

$ g(n) = \sum_{1 \leq m \leq n} f(\left\lfloor\frac{n}{m}\right \rfloor ) \Leftrightarrow f(n) = \sum_{1\leq m\leq n} \mu(m)g(\left\lfloor\frac{n}{m}\right\rfloor)$
\importcode{code/number-theory/Mobius.h}